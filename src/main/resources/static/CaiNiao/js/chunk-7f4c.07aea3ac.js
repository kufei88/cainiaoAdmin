(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7f4c"],{"632e":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Input",{staticStyle:{width:"350px","margin-bottom":"10px",float:"left"},attrs:{search:"","enter-button":"查询",placeholder:"请输入查询关键字，如公司名称、联系人、登记状态"},on:{"on-search":e.searchButton},model:{value:e.searchData,callback:function(t){e.searchData=t},expression:"searchData"}}),a("Button",{staticStyle:{float:"right"},attrs:{icon:"md-download",loading:e.exportLoading},on:{click:e.exportExcelModel}},[e._v("模板下载")]),a("Button",{staticStyle:{float:"right"},attrs:{icon:"md-download",loading:e.exportLoading},on:{click:e.exportExcel}},[e._v("导出文件")]),a("Upload",{staticStyle:{float:"right"},attrs:{action:"","before-upload":e.handleBeforeUpload,accept:".xls, .xlsx"}},[a("Button",{attrs:{icon:"ios-cloud-upload-outline",loading:e.uploadLoading},on:{click:e.handleUploadFile}},[e._v("上传文件")])],1),a("Button",{staticStyle:{float:"right"},attrs:{icon:"md-add"},on:{click:function(t){e.isAddNewData=!0}}},[e._v("新增")]),a("div",{staticStyle:{clear:"both"}}),a("Modal",{attrs:{closable:!1,"mask-closable":!1,title:"新增园区企业信息填写"},model:{value:e.isAddNewData,callback:function(t){e.isAddNewData=t},expression:"isAddNewData"}},[a("Form",{ref:"formValidate",attrs:{model:e.formValidate,rules:e.ruleValidate,"label-width":100}},[a("FormItem",{attrs:{label:"公司名称",prop:"enterpriseName"}},[a("Input",{model:{value:e.formValidate.enterpriseName,callback:function(t){e.$set(e.formValidate,"enterpriseName",t)},expression:"formValidate.enterpriseName"}})],1),a("FormItem",{attrs:{label:"联系人",prop:"enterprisePerson"}},[a("Input",{model:{value:e.formValidate.enterprisePerson,callback:function(t){e.$set(e.formValidate,"enterprisePerson",t)},expression:"formValidate.enterprisePerson"}})],1),a("FormItem",{attrs:{label:"联系电话",prop:"contactNumber"}},[a("Input",{model:{value:e.formValidate.contactNumber,callback:function(t){e.$set(e.formValidate,"contactNumber",t)},expression:"formValidate.contactNumber"}})],1),a("FormItem",{attrs:{label:"登记状态",prop:"state"}},[a("Select",{attrs:{transfer:""},model:{value:e.formValidate.state,callback:function(t){e.$set(e.formValidate,"state",t)},expression:"formValidate.state"}},e._l(e.stateList,function(t){return a("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label))])}))],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"text",size:"large"},on:{click:function(t){e.handleReset("formValidate")}}},[e._v("取消")]),a("Button",{attrs:{type:"primary",size:"large"},on:{click:function(t){e.handleSubmit("formValidate")}}},[e._v("确定")])],1)],1),a("Table",{ref:"table",attrs:{border:"",columns:e.dataColumns,data:e.pageData,height:"522"},scopedSlots:e._u([{key:"enterprisePerson",fn:function(t){var r=t.row,n=t.index;return[e.editIndex===n?a("Input",{attrs:{type:"text"},model:{value:e.editEnterprisePerson,callback:function(t){e.editEnterprisePerson=t},expression:"editEnterprisePerson"}}):a("span",[e._v(e._s(r.enterprisePerson))])]}},{key:"contactNumber",fn:function(t){var r=t.row,n=t.index;return[e.editIndex===n?a("Input",{attrs:{type:"text"},model:{value:e.editContactNumber,callback:function(t){e.editContactNumber=t},expression:"editContactNumber"}}):a("span",[e._v(e._s(r.contactNumber))])]}},{key:"state",fn:function(t){var r=t.row,n=t.index;return[e.editIndex===n&&"已入驻"!=r.state?a("Select",{attrs:{transfer:""},model:{value:e.editState,callback:function(t){e.editState=t},expression:"editState"}},e._l(e.stateList,function(t){return a("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label))])})):a("span",[e._v(e._s(r.state))])]}},{key:"action",fn:function(t){var r=t.row,n=t.index;return[e.editIndex===n?a("div",[a("Button",{staticStyle:{"margin-right":"5px"},attrs:{type:"primary"},on:{click:function(t){e.handleSave(n)}}},[e._v("保存")]),a("Button",{attrs:{type:"error"},on:{click:function(t){e.handleCancel(n)}}},[e._v("取消")])],1):a("div",[a("Button",{staticStyle:{"margin-right":"5px"},attrs:{type:"primary"},on:{click:function(t){e.handleEdit(r,n)}}},[e._v("修改")]),a("Button",{attrs:{type:"error"},on:{click:function(t){e.handleDelete(n)}}},[e._v("删除")])],1)]}}])}),a("span",[e._v("记录总共 "+e._s(this.dataCount)+" 条")]),a("Page",{attrs:{total:e.dataCount,"show-sizer":"",current:e.pageCurrent,"page-size-opts":[10,20,50,100],align:"center"},on:{"on-change":e.changePage,"on-page-size-change":e.changePageNumber}})],1)},n=[],i=(a("28a5"),a("7f7f"),a("66df")),s=a("0a21"),o={data:function(){return{stateList:[{value:"未注册",label:"未注册"},{value:"已注册",label:"已注册"}],isAddNewData:!1,uploadLoading:!1,file:null,uploadTableData:[],exportLoading:!1,excelDataModel:[{enterpriseName:"例如：某某有限公司",enterprisePerson:"填写公司主要负责人名称",contactNumber:"填写负责人电话",state:"企业登记状态，如未注册、已注册、已入驻"}],editIndex:-1,editEnterprisePerson:"",editContactNumber:"",editState:"",searchData:"",pageCurrent:1,pageStart:0,dataCount:0,pageSize:10,pageData:[],dataColumns:[{type:"index",width:60,align:"center",indexMethod:function(e){return e._index+1+(e.pageCurrent-1)*e.pageSize}},{title:"公司名称",key:"enterpriseName",align:"center"},{title:"联系人",key:"enterprisePerson",align:"center",slot:"enterprisePerson"},{title:"联系电话",key:"contactNumber",align:"center",slot:"contactNumber"},{title:"登记状态",key:"state",align:"center",slot:"state"},{title:"添加时间",key:"insertTime",align:"center"},{title:"修改时间",key:"updateTime",align:"center"},{title:"操作",slot:"action",width:180,align:"center"}],formValidate:{enterpriseName:"",enterprisePerson:"",enterpriseTelphone:"",state:"未注册"},ruleValidate:{enterpriseName:[{required:!0,message:"公司名称不得为空",trigger:"blur"}],enterprisePerson:[{required:!0,message:"联系人不得为空",trigger:"blur"}],contactNumber:[{required:!0,message:"请填写正确的联系方式",trigger:"blur",transform:function(e){var t=/^[1][3,4,5,7,8][0-9]{9}$/;return!!t.test(e)&&String(e)}}],state:[{required:!0,message:"登记状态不得为空",trigger:"change"}]}}},methods:{handleSubmit:function(e){var t=this;this.$refs[e].validate(function(a){if(a){var r=t,n=t.formValidate;n.insertTime=t.getFormatDate(),i["a"].request({url:"/enterprise/insertEnterpriseList",method:"post",headers:{"Content-Type":"application/json;charset=UTF-8"},data:n}).then(function(e){1==e.data?(r.$Message.success("添加成功"),r.getRequestData(r.pageCurrent)):-1==e.data?r.$Message.error("已有该企业存在"):r.$Message.error("添加失败")}).then(function(){r.$refs[e].resetFields()}),t.isAddNewData=!1}})},handleReset:function(e){this.$refs[e].resetFields(),this.isAddNewData=!1},searchButton:function(e){this.searchData=e,this.pageCurrent=1,this.getRequestData(this.pageCurrent)},uploadExcelData:function(e){for(var t in e)e[t].enterpriseName=e[t].公司名称,e[t].enterprisePerson=e[t].联系人,e[t].contactNumber=e[t].联系电话,e[t].state=e[t].登记状态,e[t].insertTime=this.getFormatDate(),delete e[t].公司名称,delete e[t].联系人,delete e[t].联系电话,delete e[t].登记状态;var a=0;for(var t in e)void 0==e[t].enterpriseName||null==e[t].enterpriseName||""==e[t].enterpriseName||""==e[t].enterprisePerson||null==e[t].enterprisePerson||void 0==e[t].enterprisePerson||""==e[t].contactNumber||null==e[t].contactNumber||e[t].contactNumber,""==e[t].state||null==e[t].state||void 0==e[t].state?a+=1:a+=0;if(0==a){var r=this;i["a"].request({url:"/enterprise/uploadEnterpriseList",method:"post",headers:{"Content-Type":"application/json;charset=UTF-8"},data:e}).then(function(t){if(0==t.data)r.$Message.error("未知原因，导入失败");else if(-1==t.data)r.$Message.error("导入失败，表内无数据");else if(-2==t.data)r.$Message.error("导入失败，数据全部存在");else{if(t.data==e.length)r.$Message.success("导入成功");else if(t.data<e.length){var a=e.length-t.data;r.$Message.info(a+"条数据因无效而未导入")}r.getRequestData(r.pageCurrent)}})}else this.$Message.error("该表内有"+a+"行数据有空项"),a=0},initUpload:function(){this.file=null,this.uploadTableData=[]},handleUploadFile:function(){this.initUpload()},handleBeforeUpload:function(e){var t=e.name.split(".").pop().toLocaleLowerCase();return"xlsx"===t||"xls"===t?(this.readFile(e),this.file=e):this.$Notice.warning({title:"文件类型错误",desc:"文件："+e.name+"不是EXCEL文件，请选择后缀为.xlsx或者.xls的EXCEL文件。"}),!1},readFile:function(e){var t=this,a=new FileReader;a.readAsArrayBuffer(e),a.onloadstart=function(e){t.uploadLoading=!0},a.onprogress=function(e){t.progressPercent=Math.round(e.loaded/e.total*100)},a.onerror=function(e){t.$Message.error("文件读取出错")},a.onload=function(e){var a=e.target.result,r=s["a"].read(a,"array"),n=(r.header,r.results);t.uploadTableData=n,t.uploadLoading=!1,t.uploadExcelData(t.uploadTableData)}},exportExcelModel:function(){if(this.excelDataModel.length){this.exportLoading=!0;var e={title:["公司名称","联系人","联系电话","登记状态"],key:["enterpriseName","enterprisePerson","contactNumber","state"],data:this.excelDataModel,autoWidth:!0,filename:"园区企业管理信息表模板"};s["a"].export_array_to_excel(e),this.exportLoading=!1}else this.$Message.info("表格数据不能为空！")},exportExcel:function(){if(this.pageData.length){this.exportLoading=!0;var e={title:["公司名称","联系人","联系电话","登记状态"],key:["enterpriseName","enterprisePerson","contactNumber","state"],data:this.pageData,autoWidth:!0,filename:"园区企业管理信息表"};s["a"].export_array_to_excel(e),this.exportLoading=!1}else this.$Message.info("表格数据不能为空！")},handleEdit:function(e,t){this.editEnterprisePerson=e.enterprisePerson,this.editContactNumber=e.contactNumber,this.editState=e.state,this.editIndex=t},handleCancel:function(e){this.editIndex=-1},handleSave:function(e){var t=this;if(this.pageData[e].enterprisePerson=this.editEnterprisePerson,this.pageData[e].contactNumber=this.editContactNumber,this.pageData[e].state=this.editState,void 0==this.pageData[e].enterpriseName||null==this.pageData[e].enterpriseName||""==this.pageData[e].enterpriseName||""==this.pageData[e].enterprisePerson||null==this.pageData[e].enterprisePerson||void 0==this.pageData[e].enterprisePerson||""==this.pageData[e].contactNumber||null==this.pageData[e].contactNumber||void 0==this.pageData[e].contactNumber)this.$Message.error("有内容未填写");else if(0==this.isNumberRule(this.pageData[e].contactNumber))this.$Message.error("请输入正确的联系方式");else{this.pageData[e].updateTime=this.getFormatDate();var a=this.pageData[e];i["a"].request({url:"/enterprise/updateEnterpriseList",method:"post",headers:{"Content-Type":"application/json;charset=UTF-8"},data:a}).then(function(e){1==e.data?t.$Message.success("保存成功"):-1==e.data?t.$Message.error("已有该企业"):t.$Message.error("保存失败"),t.getRequestData(t.pageCurrent)}).then(function(){t.changePage(t.pageCurrent)}),this.editIndex=-1}},handleDelete:function(e){var t=this;this.$Modal.confirm({title:"删除提示",content:"<p>是否确认删除该条记录？</p>",onOk:function(){var a=t,r=t.pageData[e];i["a"].request({url:"/enterprise/deleteEnterpriseList",method:"post",headers:{"Content-Type":"application/json;charset=UTF-8"},data:r}).then(function(e){1==e.data?(a.$Message.success("删除成功"),a.pageData.length<=1&&1!=a.pageCurrent&&(a.pageCurrent=a.pageCurrent-1),a.getRequestData(a.pageCurrent)):a.$Message.error("删除失败")})},onCancel:function(){}}),this.editIndex=-1},changePageNumber:function(e){this.pageSize=e,1===this.pageCurrent&&this.changePage(this.pageCurrent)},changePage:function(e){this.pageCurrent=e,this.getRequestData(e)},getRequestData:function(e){var t=this;this.pageStart=(e-1)*this.pageSize,i["a"].request({url:"/enterprise/getSearchList",method:"get",params:{search:this.searchData,dataStart:this.pageStart,dataSize:this.pageSize}}).then(function(e){t.pageData=e.data.enterpriseList,t.dataCount=e.data.dataCount,t.addPageCurrentAndPageSize(t.pageData)})},getFormatDate:function(){var e=new Date,t=e.getMonth()+1,a=e.getDate();t>=1&&t<=9&&(t="0"+t),a>=0&&a<=9&&(a="0"+a);var r=e.getFullYear()+"-"+t+"-"+a+" "+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds();return r},addPageCurrentAndPageSize:function(e){for(var t in e)e[t].pageCurrent=this.pageCurrent,e[t].pageSize=this.pageSize},isNumberRule:function(e){var t=/^[1][3,4,5,7,8][0-9]{9}$/;return!!t.test(e)}},mounted:function(){this.getRequestData(this.pageCurrent)}},l=o,d=(a("7d0b"),a("2877")),u=Object(d["a"])(l,r,n,!1,null,"120517df",null);u.options.__file="enterprise.vue";t["default"]=u.exports},"742e":function(e,t,a){},"7d0b":function(e,t,a){"use strict";var r=a("742e"),n=a.n(r);n.a}}]);