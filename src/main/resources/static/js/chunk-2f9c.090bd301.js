(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2f9c"],{3846:function(t,e,a){a("9e1e")&&"g"!=/./g.flags&&a("86cc").f(RegExp.prototype,"flags",{configurable:!0,get:a("0bfb")})},"4b44":function(t,e,a){},"6b54":function(t,e,a){"use strict";a("3846");var r=a("cb7c"),n=a("0bfb"),o=a("9e1e"),i="toString",s=/./[i],l=function(t){a("2aba")(RegExp.prototype,i,t,!0)};a("79e5")(function(){return"/a/b"!=s.call({source:"a",flags:"b"})})?l(function(){var t=r(this);return"/".concat(t.source,"/","flags"in t?t.flags:!o&&t instanceof RegExp?n.call(t):void 0)}):s.name!=i&&l(function(){return s.call(this)})},"6ca2":function(t,e,a){"use strict";var r=a("4b44"),n=a.n(r);n.a},d1b1:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Input",{staticStyle:{width:"400px","margin-bottom":"10px",float:"left"},attrs:{search:"","enter-button":"查询",placeholder:"请输入查询关键字,如公司名称、楼栋名称、房间号"},on:{"on-search":t.searchButton},model:{value:t.searchData,callback:function(e){t.searchData=e},expression:"searchData"}}),a("Button",{staticStyle:{float:"right","margin-left":"10px"},attrs:{type:"error"},on:{click:t.handleDelete}},[t._v("退租")]),a("Button",{staticStyle:{float:"right","margin-left":"10px"},attrs:{type:"warning"},on:{click:t.handleChange}},[t._v("合同变更")]),a("Button",{staticStyle:{float:"right","margin-left":"10px"},attrs:{type:"primary"},on:{click:t.handleDetailed}},[t._v("合同详情")]),a("Button",{staticStyle:{float:"right","margin-left":"10px"},attrs:{type:"primary"},on:{click:t.handlePay}},[t._v("合同缴费")]),a("Button",{staticStyle:{float:"right","margin-left":"10px"},attrs:{type:"primary"},on:{click:function(e){t.isAddNewData=!0}}},[t._v("新增合同")]),a("div",{staticStyle:{clear:"both"}}),a("Modal",{attrs:{closable:!1,"mask-closable":!1,scrollable:!0,width:"70",title:"合同详情信息"},model:{value:t.isDetailed,callback:function(e){t.isDetailed=e},expression:"isDetailed"}},[a("p",{staticStyle:{"margin-top":"10px","margin-bottom":"10px",display:"flex"}},[a("span",{staticStyle:{"font-size":"14px",flex:"1"}},[a("strong",[t._v("所属楼栋:")]),t._v(" "+t._s(t.selectContract.buildingName))]),a("span",{staticStyle:{"font-size":"14px","margin-left":"35px",flex:"1"}},[a("strong",[t._v("房间号:")]),t._v(" "+t._s(t.selectContract.roomNumber))]),a("span",{staticStyle:{"font-size":"14px","margin-left":"35px",flex:"2"}},[a("strong",[t._v("公司名称:")]),t._v(" "+t._s(t.selectContract.owner))])]),a("p",{staticStyle:{"margin-top":"10px","margin-bottom":"10px",display:"flex"}},[a("span",{staticStyle:{"font-size":"14px",flex:"1"}},[a("strong",[t._v("租金单价:")]),t._v(" "+t._s(t.selectContract.depositOnContracts)+" 元/月/㎡")]),a("span",{staticStyle:{"font-size":"14px","margin-left":"35px",flex:"1"}},[a("strong",[t._v("合同保证金:")]),t._v(" "+t._s(t.selectContract.depositOnContracts)+" 元")]),a("span",{staticStyle:{"font-size":"14px","margin-left":"35px",flex:"1"}},[a("strong",[t._v("签订时间:")]),t._v(" "+t._s(t.selectContract.insertTime))]),0!=t.selectContract.noPayPeriod?a("span",{staticStyle:{"font-size":"14px","margin-left":"35px",flex:"1"}},[a("strong",[t._v("剩余未缴费租期:")]),t._v(" "+t._s(t.selectContract.noPayPeriod)+" 月")]):a("span",{staticStyle:{"font-size":"14px","margin-left":"35px",flex:"1"}},[a("strong",[t._v("合同费用:")]),t._v(" 已缴清")])]),a("Table",{ref:"showTable",attrs:{border:"","highlight-row":"",columns:t.showColumns,data:t.showTableData,height:"400"}}),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"primary",size:"large"},on:{click:function(e){t.handleSubmit("showTable")}}},[t._v("确定")])],1)],1),a("Modal",{attrs:{closable:!1,"mask-closable":!1,scrollable:!0,title:"合同所属人变更"},model:{value:t.isChangeOwner,callback:function(e){t.isChangeOwner=e},expression:"isChangeOwner"}},[a("Form",{ref:"changeForm",attrs:{model:t.changeFormData,rules:t.changeFormRule,"label-width":100},nativeOn:{submit:function(t){t.preventDefault()}}},[a("FormItem",{attrs:{label:"合同所属人:",prop:"owner"}},[a("Input",{attrs:{clearable:""},model:{value:t.changeFormData.owner,callback:function(e){t.$set(t.changeFormData,"owner",e)},expression:"changeFormData.owner"}})],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"text",size:"large"},on:{click:function(e){t.handleReset("changeForm")}}},[t._v("取消")]),a("Button",{attrs:{type:"primary",size:"large"},on:{click:function(e){t.handleSubmit("changeForm")}}},[t._v("确定")])],1)],1),a("Modal",{attrs:{closable:!1,"mask-closable":!1,scrollable:!0,title:"缴费业务"},model:{value:t.isPayRent,callback:function(e){t.isPayRent=e},expression:"isPayRent"}},[a("Form",{ref:"payForm",attrs:{model:t.payFormData,rules:t.payFormRule,"label-width":130}},[a("FormItem",{attrs:{label:"所属楼栋:",prop:"buildingName"}},[a("Input",{staticStyle:{width:"200px"},attrs:{readonly:""},model:{value:t.payFormData.buildingName,callback:function(e){t.$set(t.payFormData,"buildingName",e)},expression:"payFormData.buildingName"}})],1),a("FormItem",{attrs:{label:"房号:",prop:"roomNumber"}},[a("Input",{staticStyle:{width:"200px"},attrs:{readonly:""},model:{value:t.payFormData.roomNumber,callback:function(e){t.$set(t.payFormData,"roomNumber",e)},expression:"payFormData.roomNumber"}})],1),a("FormItem",{attrs:{label:"业主:",prop:"owner"}},[a("p",[t._v(t._s(t.payFormData.owner=t.showOwner(t.payFormData.buildingName,t.payFormData.roomNumber)))])]),a("FormItem",{attrs:{label:"租期周期(月):",prop:"period"}},[a("Input",{staticStyle:{width:"200px"},attrs:{clearable:""},on:{"on-change":function(e){t.selectEndDate(t.payFormData.startPayTime)}},model:{value:t.payFormData.period,callback:function(e){t.$set(t.payFormData,"period",e)},expression:"payFormData.period"}})],1),a("FormItem",{attrs:{label:"缴费起始租期:",prop:"startPayTime"}},[a("DatePicker",{attrs:{type:"date",format:"yyyy-MM-dd",readonly:""},model:{value:t.payFormData.startPayTime,callback:function(e){t.$set(t.payFormData,"startPayTime",e)},expression:"payFormData.startPayTime"}})],1),a("FormItem",{attrs:{label:"缴费终止租期:",prop:"endPayTime"}},[a("DatePicker",{attrs:{type:"date",format:"yyyy-MM-dd",readonly:""},model:{value:t.payFormData.endPayTime,callback:function(e){t.$set(t.payFormData,"endPayTime",e)},expression:"payFormData.endPayTime"}})],1),a("FormItem",{attrs:{label:"租金单价:",prop:"unitPrice"}},[""==t.payFormData.unitPrice?a("p",[t._v(" 0 (元/月/平米)")]):a("p",[t._v(" "+t._s(t.payFormData.unitPrice)+" (元/月/平米)")])]),a("FormItem",{attrs:{label:"租金费用:",prop:"rentCost"}},[a("p",[t._v(t._s(t.payFormData.rentCost=t.getRentCost(t.payFormData.period,t.payFormData.unitPrice,t.payRoomData,t.payFormData))+" 元")])]),a("FormItem",{attrs:{label:"物业费用:",prop:"propertyFee"}},[a("p",[t._v(t._s(t.payFormData.propertyFee=t.getPropertyFee(t.payFormData.period,t.settingData,t.payRoomData,t.payFormData))+" 元")])]),a("FormItem",{attrs:{label:"能耗公摊:",prop:"energySharing"}},[a("p",[t._v(t._s(t.payFormData.energySharing=t.getPropertyFee(t.payFormData.period,t.energySharingPrice,t.payRoomData,t.payFormData))+" 元")])]),a("FormItem",{attrs:{label:"费用总计:",prop:"totalCost"}},[a("p",[t._v(t._s(t.payFormData.totalCost=t.getTotalCost(t.payFormData.rentCost,t.payFormData.propertyFee,t.payFormData.energySharing,"payForm"))+" 元")])])],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"text",size:"large"},on:{click:function(e){t.handleReset("payForm")}}},[t._v("取消")]),a("Button",{attrs:{type:"primary",size:"large"},on:{click:function(e){t.handleSubmit("payForm")}}},[t._v("确定")])],1)],1),a("Modal",{attrs:{closable:!1,"mask-closable":!1,scrollable:!0,title:"租赁合同信息"},model:{value:t.isAddNewData,callback:function(e){t.isAddNewData=e},expression:"isAddNewData"}},[a("Form",{ref:"addForm",attrs:{model:t.addFormData,rules:t.addFormRule,"label-width":100}},[a("FormItem",{attrs:{label:"所属楼栋:",prop:"buildingName"}},[a("Select",{staticStyle:{width:"200px"},attrs:{"transfer:true":""},model:{value:t.addFormData.buildingName,callback:function(e){t.$set(t.addFormData,"buildingName",e)},expression:"addFormData.buildingName"}},t._l(t.buildingData,function(e){return a("Option",{key:e.buildingName,attrs:{value:e.buildingName}},[t._v(t._s(e.buildingName))])}))],1),a("FormItem",{attrs:{label:"房号:",prop:"roomNumber"}},[a("Select",{staticStyle:{width:"200px"},attrs:{"transfer:true":""},model:{value:t.addFormData.roomNumber,callback:function(e){t.$set(t.addFormData,"roomNumber",e)},expression:"addFormData.roomNumber"}},t._l(t.selectRoomNumber(t.roomData,t.addFormData),function(e){return a("Option",{key:e.roomNumber,attrs:{value:e.roomNumber}},[t._v(t._s(e.roomNumber))])}))],1),a("FormItem",{attrs:{label:"业主:",prop:"owner"}},[a("Select",{attrs:{filterable:"","not-found-text":"请输入公司名称"},on:{"on-query-change":t.getCompanyData},model:{value:t.addFormData.owner,callback:function(e){t.$set(t.addFormData,"owner",e)},expression:"addFormData.owner"}},t._l(t.companyData,function(e){return a("Option",{key:e.id,attrs:{value:e.enterpriseName}},[t._v(t._s(e.enterpriseName))])}))],1),a("FormItem",{attrs:{label:"合同保证金:",prop:"depositOnContracts"}},[a("Input",{attrs:{clearable:""},model:{value:t.addFormData.depositOnContracts,callback:function(e){t.$set(t.addFormData,"depositOnContracts",e)},expression:"addFormData.depositOnContracts"}})],1),a("FormItem",{attrs:{label:"租金单价(元/月/平米):",prop:"unitPrice"}},[a("Input",{attrs:{clearable:""},model:{value:t.addFormData.unitPrice,callback:function(e){t.$set(t.addFormData,"unitPrice",e)},expression:"addFormData.unitPrice"}})],1),a("FormItem",{attrs:{label:"租期(月):",prop:"rentPeriod"}},[a("Input",{attrs:{clearable:""},model:{value:t.addFormData.rentPeriod,callback:function(e){t.$set(t.addFormData,"rentPeriod",e)},expression:"addFormData.rentPeriod"}})],1),a("FormItem",{attrs:{label:"起租期:",prop:"startRentTime"}},[a("DatePicker",{attrs:{type:"date",placeholder:"请选择日期",format:"yyyy-MM-dd"},on:{"on-change":t.selectStartDate},model:{value:t.addFormData.startRentTime,callback:function(e){t.$set(t.addFormData,"startRentTime",e)},expression:"addFormData.startRentTime"}})],1),a("FormItem",{attrs:{label:"终止期:",prop:"endRentTime"}},[a("DatePicker",{attrs:{type:"date",placeholder:"请选择日期",format:"yyyy-MM-dd",readonly:""},model:{value:t.addFormData.endRentTime,callback:function(e){t.$set(t.addFormData,"endRentTime",e)},expression:"addFormData.endRentTime"}})],1),a("FormItem",{attrs:{label:"租金费用:",prop:"rentCost"}},[a("p",[t._v(t._s(t.addFormData.rentCost=t.getRentCost(t.addFormData.rentPeriod,t.addFormData.unitPrice,t.roomData,t.addFormData))+" 元")])]),a("FormItem",{attrs:{label:"物业费用:",prop:"propertyFee"}},[a("p",[t._v(t._s(t.addFormData.propertyFee=t.getPropertyFee(t.addFormData.rentPeriod,t.settingData,t.roomData,t.addFormData))+" 元")])]),a("FormItem",{attrs:{label:"能耗公摊:",prop:"energySharing"}},[a("p",[t._v(t._s(t.addFormData.energySharing=t.getPropertyFee(t.addFormData.rentPeriod,t.energySharingPrice,t.roomData,t.addFormData))+" 元")])]),a("FormItem",{attrs:{label:"费用总计:",prop:"totalCost"}},[a("p",[t._v(t._s(t.addFormData.totalRent=t.getTotalCost(t.addFormData.rentCost,t.addFormData.propertyFee,t.addFormData.energySharing,"addForm"))+" 元")])])],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"text",size:"large"},on:{click:function(e){t.handleReset("addForm")}}},[t._v("取消")]),a("Button",{attrs:{type:"primary",size:"large"},on:{click:function(e){t.handleSubmit("addForm")}}},[t._v("确定")])],1)],1),a("Table",{ref:"currentRowTable",attrs:{border:"","highlight-row":"","row-class-name":t.rowClassName,columns:t.dataColumns,data:t.pageData,height:"522"},on:{"on-row-click":t.currentChange}}),a("span",[t._v("记录总共 "+t._s(this.dataCount)+" 条")]),a("Page",{attrs:{total:t.dataCount,"show-sizer":"",current:t.pageCurrent,"page-size-opts":[10,20,50,100],align:"center"},on:{"on-change":t.changePage,"on-page-size-change":t.changePageNumber}})],1)},n=[],o=(a("7f7f"),a("6b54"),a("28a5"),a("cadf"),a("551c"),a("097d"),a("66df")),i={data:function(){return{companyData:[],showIndex:-1,selectContract:{},showColumns:[{type:"index",width:60,align:"center",indexMethod:function(t){return t._index+1+(t.pageCurrent-1)*t.pageSize}},{title:"合同所属人",key:"owner",align:"center"},{title:"缴费租期",key:"period",align:"center"},{title:"缴费金额",key:"totalCost",align:"center"},{title:"缴费起始租期",key:"startPayTime",align:"center"},{title:"缴费终止租期",key:"endPayTime",align:"center"},{title:"缴费时间",key:"insertTime",align:"center"},{title:"变更时间",key:"updateTime",align:"center"},{title:"合同变更",key:"isChangeOwner",align:"center"}],showTableData:[],isDetailed:!1,changeFormRule:{owner:[{required:!0,message:"合同所属人不得为空",trigger:"blur"}]},changeFormData:{owner:"",roomNumber:"",buildingName:"",depositOnContracts:"",rentPeriod:"",startRentTime:"",endRentTime:"",insertTime:""},isChangeOwner:!1,settingData:"",energySharingPrice:"",payBuildingData:[],payRoomData:[],payFormData:{owner:"",roomNumber:"",buildingName:"",unitPrice:"",period:"",rentCost:"",propertyFee:"",energySharing:"",totalCost:"",insertTime:"",startPayTime:"",endPayTime:""},payFormRule:{roomNumber:[{required:!0,message:"房号不得为空",trigger:"change"}],buildingName:[{required:!0,message:"所属楼栋不得为空",trigger:"change"}],period:[{required:!0,message:"请输入正确的租期",trigger:"blur",transform:function(t){var e=/^\d+$/;return!!e.test(t)&&String(t)}}]},isSelectRow:!1,deleteFormData:{owner:"",roomNumber:"",buildingName:"",depositOnContracts:"",rentPeriod:"",startRentTime:"",endRentTime:"",insertTime:""},addFormData:{owner:"",roomNumber:"",buildingName:"",depositOnContracts:"",rentPeriod:"",startRentTime:"",endRentTime:"",unitPrice:"",rentCost:"",propertyFee:"",energySharing:"",totalCost:"",insertTime:""},addFormRule:{roomNumber:[{required:!0,message:"房号不得为空",trigger:"change"}],buildingName:[{required:!0,message:"所属楼栋不得为空",trigger:"change"}],owner:[{required:!0,message:"业主不得为空",trigger:"change"}],depositOnContracts:[{required:!0,message:"请输入正确的数额",trigger:"blur",transform:function(t){var e=/^\d*\.?\d+$/;return!!e.test(t)&&String(t)}}],rentPeriod:[{required:!0,message:"请输入正确的租期",trigger:"blur",transform:function(t){var e=/^\d+$/;return!!e.test(t)&&String(t)}}],startRentTime:[{required:!0,message:"起租期不得为空",trigger:"blur"}],unitPrice:[{required:!0,message:"请输入正确的数额",trigger:"blur",transform:function(t){var e=/^\d*\.?\d+$/;return!!e.test(t)&&String(t)}}]},isPayRent:!1,isAddNewData:!1,searchData:"",pageCurrent:1,pageStart:0,dataCount:0,pageSize:10,pageData:[],roomData:[],buildingData:[],dataColumns:[{type:"index",width:60,align:"center",indexMethod:function(t){return t._index+1+(t.pageCurrent-1)*t.pageSize}},{title:"公司",key:"owner",align:"center"},{title:"所属楼栋",key:"buildingName",align:"center"},{title:"房间号",key:"roomNumber",align:"center",width:100},{title:"租期",key:"rentPeriod",align:"center",width:80},{title:"起租期",key:"startRentTime",align:"center"},{title:"终止期",key:"endRentTime",align:"center"},{title:"租金总计",key:"totalRent",align:"center"},{title:"首期租金",key:"firstRent",align:"center"},{title:"签订时间",key:"insertTime",align:"center"}]}},methods:{getCompanyData:function(t){var e=this;""!=t&&void 0!=t&&null!=t&&o["a"].request({url:"Account/getAllCompany",method:"get",params:{companyName:t}}).then(function(t){e.companyData=t.data})},rowClassName:function(t,e){var a=this.getFormatDate().split(" ")[0],r=t.endRentTime.toString(),n=t.lastPayTime.toString(),o=0,i=0;return o=this.getDaterange(a,r),i=this.getDaterange(a,n),console.log("range2",i),o<=30?this.showIndex==e?"":"demo-table-error-row":i<=30&&i>0&&void 0!=t.firstRent?this.showIndex==e?"":"demo-table-warning-row":""},getDaterange:function(t,e){var a=t.split("-"),r=e.split("-"),n=parseInt(a[0]),o=parseInt(r[0]),i=parseInt(a[1]),s=parseInt(r[1]),l=parseInt(a[2]),d=parseInt(r[2]),m=0,c=new Date(n,i,0);return m=12*o+s-12*n-i<2?s==i?d-l:c.getDate()-l+d:32,m},getPayUnitPrice:function(){var t=this,e=this.payFormData;o["a"].request({url:"lease/getPayUnitPrice",method:"post",headers:{"Content-Type":"application/json;charset=UTF-8"},data:e}).then(function(e){t.payFormData.unitPrice=e.data})},searchButton:function(t){this.searchData=t,this.pageCurrent=1,this.getRequestData(this.pageCurrent)},handleDetailed:function(){1==this.isSelectRow?this.isDetailed=!0:this.$Message.error("请先选择记录")},handlePay:function(){1==this.isSelectRow?this.isPayRent=!0:this.$Message.error("请先选择记录")},handleChange:function(){1==this.isSelectRow?this.isChangeOwner=!0:this.$Message.error("请先选择记录")},showOwner:function(t,e){var a="";for(var r in this.payRoomData)this.payRoomData[r].buildingName==t&&this.payRoomData[r].roomNumber==e&&(a=this.payRoomData[r].owner);return a},getTotalCost:function(t,e,a,r){var n=0;return""!=t&&null!=t&&void 0!=t&&""!=e&&null!=e&&void 0!=e&&""!=a&&null!=a&&void 0!=a&&(n=parseFloat(t)+parseFloat(e)+parseFloat(a),"addForm"==r&&""!=this.addFormData.depositOnContracts&&null!=this.addFormData.depositOnContracts&&void 0!=this.addFormData.depositOnContracts&&(n+=parseFloat(this.addFormData.depositOnContracts))),n},getPropertyFee:function(t,e,a,r){var n=0,o="";for(var i in a)a[i].buildingName==r.buildingName&&a[i].roomNumber==r.roomNumber&&(o=a[i].rentArea);return""!=t&&null!=t&&void 0!=t&&""!=e&&null!=e&&void 0!=e&&""!=o&&null!=o&&void 0!=o&&(n=parseFloat(t)*parseFloat(e)*parseFloat(o)),n},getRentCost:function(t,e,a,r){var n=0,o="";for(var i in a)a[i].buildingName==r.buildingName&&a[i].roomNumber==r.roomNumber&&(o=a[i].rentArea);return""!=t&&null!=t&&void 0!=t&&""!=e&&null!=e&&void 0!=e&&""!=o&&null!=o&&void 0!=o&&(n=parseFloat(t)*parseFloat(e)*parseFloat(o)),n},currentChange:function(t,e){this.showIndex=e,this.showContract(t,e),this.payFormData=this.getPayForm(t),this.deleteFormData=t,this.changeFormData=t,this.isSelectRow=!0},getPayForm:function(t){var e={};return e.owner=t.owner,e.roomNumber=t.roomNumber,e.buildingName=t.buildingName,e.startPayTime=t.lastPayTime,e.unitPrice=t.unitPrice,e},handleDelete:function(){var t=this;1==this.isSelectRow?this.$Modal.confirm({title:"退租提示",content:"<p>是否确认将该房间退租？</p>",onOk:function(){var e=t,a=t.deleteFormData;o["a"].request({url:"lease/deleteLeaseList",method:"post",headers:{"Content-Type":"application/json;charset=UTF-8"},data:a}).then(function(t){1==t.data?(e.$Message.success("退租成功"),e.pageData.length<=1&&1!=e.pageCurrent&&(e.pageCurrent=e.pageCurrent-1),e.getRequestData(e.pageCurrent)):-1==t.data?e.$Message.error("合同未缴清费用"):e.$Message.error("退租失败"),e.isSelectRow=!1})},onCancel:function(){}}):this.$Message.error("请先选择记录")},selectRoomNumber:function(t,e){var a=[];for(var r in t)t[r].buildingName==e.buildingName&&a.push(t[r]);return a},handleSubmit:function(t){var e=this;switch(t){case"payForm":this.$refs[t].validate(function(a){if(a){var r=e;e.payFormData.insertTime=e.getFormatDate();var n=e.payFormData;o["a"].request({url:"lease/insertLeaseCostInfo",method:"post",headers:{"Content-Type":"application/json;charset=UTF-8"},data:n}).then(function(t){1==t.data?(r.$Message.success("缴费成功"),r.getRequestData(r.pageCurrent),r.isPayRent=!1):-1==t.data?r.$Message.error("缴费租期超出未缴费租期"):(r.$Message.error("缴费失败"),r.isPayRent=!1)}).then(function(){0==r.isPayRent&&r.$refs[t].resetFields()})}});break;case"addForm":this.$refs[t].validate(function(a){if(a){var r=e;e.addFormData.insertTime=e.getFormatDate();var n=e.addFormData;o["a"].request({url:"lease/insertLeaseList",method:"post",headers:{"Content-Type":"application/json;charset=UTF-8"},data:n}).then(function(t){1==t.data?(r.$Message.success("添加成功"),r.isAddNewData=!1,r.getRequestData(r.pageCurrent)):-1==t.data?r.$Message.error("该公司未登记"):(r.$Message.error("添加失败"),r.isAddNewData=!1)}).then(function(){0==r.isAddNewData&&r.$refs[t].resetFields()})}});break;case"changeForm":this.$refs[t].validate(function(a){if(a){var r=e;e.changeFormData.updateTime=e.getFormatDate();var n=e.changeFormData;o["a"].request({url:"lease/changeLeaseContractInfo",method:"post",headers:{"Content-Type":"application/json;charset=UTF-8"},data:n}).then(function(t){1==t.data?(r.$Message.success("修改成功"),r.isChangeOwner=!1,r.getRequestData(r.pageCurrent)):-1==t.data?r.$Message.error("被转让合同所属人未登记"):(r.$Message.error("修改失败"),r.isChangeOwner=!1)}).then(function(){0==r.isChangeOwner&&r.$refs[t].resetFields()})}});break;case"showTable":this.isDetailed=!1;break;default:break}},addMonth:function(t,e){var a=t.split("-"),r=parseInt(a[0]),n=parseInt(a[1]-1),o=parseInt(a[2]),i=new Date(r,n,o);i.setMonth(i.getMonth()+e),12*i.getFullYear()+i.getMonth()>12*r+n+e&&(i=new Date(i.getFullYear(),i.getMonth(),0));var s=i.getFullYear(),l=i.getMonth()+1,d=i.getDate();o=s+"-"+l+"-"+d;return o},selectEndDate:function(t){if("string"!=typeof t)var e=t.getFullYear(),a=t.getMonth()+1,r=t.getDate(),n=e+"-"+a+"-"+r;else n=t;""!=this.payFormData.period&&null!=this.payFormData.period&&void 0!=this.payFormData.period&&(this.payFormData.endPayTime=this.addMonth(n,parseInt(this.payFormData.period)))},selectStartDate:function(t){""!=this.addFormData.rentPeriod&&null!=this.addFormData.rentPeriod&&void 0!=this.addFormData.rentPeriod&&(this.addFormData.endRentTime=this.addMonth(t,parseInt(this.addFormData.rentPeriod))),this.addFormData.startRentTime=t},showContract:function(t,e){this.selectContract=t;var a=this,r=this.selectContract;o["a"].request({url:"lease/getLeaseCostList",method:"post",headers:{"Content-Type":"application/json;charset=UTF-8"},data:r}).then(function(t){a.showTableData=t.data,a.addPageCurrentAndPageSize(a.showTableData)})},changePageNumber:function(t){this.pageSize=t,1===this.pageCurrent&&this.changePage(this.pageCurrent)},changePage:function(t){this.pageCurrent=t,this.getRequestData(t)},getRequestData:function(t){var e=this;this.pageStart=(t-1)*this.pageSize,o["a"].request({url:"lease/getSearchList",method:"get",params:{search:this.searchData,start:this.pageStart,count:this.pageSize}}).then(function(t){e.pageData=t.data.leaseContractList,e.dataCount=t.data.dataCount,e.buildingData=t.data.buildingList,e.roomData=t.data.roomList,e.payBuildingData=t.data.payBuildingList,e.payRoomData=t.data.payRoomList,e.addPageCurrentAndPageSize(e.pageData)})},handleReset:function(t){switch(t){case"addForm":this.$refs[t].resetFields(),this.isAddNewData=!1;break;case"payForm":this.isPayRent=!1;break;case"changeForm":this.isChangeOwner=!1;break;default:break}},getSettingData:function(){var t=this;o["a"].request({url:"lease/getSettingList",method:"get"}).then(function(e){t.settingData=e.data})},getEnergyPrice:function(){var t=this;o["a"].request({url:"lease/getEnergyPrice",method:"get"}).then(function(e){t.energySharingPrice=e.data})},getFormatDate:function(){var t=new Date,e=t.getMonth()+1,a=t.getDate();e>=1&&e<=9&&(e="0"+e),a>=0&&a<=9&&(a="0"+a);var r=t.getFullYear()+"-"+e+"-"+a+" "+t.getHours()+":"+t.getMinutes()+":"+t.getSeconds();return r},addPageCurrentAndPageSize:function(t){for(var e in t)t[e].pageCurrent=this.pageCurrent,t[e].pageSize=this.pageSize}},mounted:function(){this.getRequestData(this.pageCurrent),this.getSettingData(),this.getEnergyPrice()}},s=i,l=(a("6ca2"),a("2877")),d=Object(l["a"])(s,r,n,!1,null,null,null);d.options.__file="lease.vue";e["default"]=d.exports}}]);